"use strict";(self["webpackChunkfront"]=self["webpackChunkfront"]||[]).push([[387],{4030:function(e,t,a){a.d(t,{$U:function(){return v},B6:function(){return r},FN:function(){return n},G4:function(){return l},HI:function(){return o},KB:function(){return k},KN:function(){return b},Su:function(){return m},Vv:function(){return d},Wb:function(){return g},_M:function(){return c},po:function(){return p},wI:function(){return u},xI:function(){return f},yx:function(){return i}});var s=a(9470);function n(e){return(0,s.Jt)("/projectManage/getProjectManageList",e)}function r(e){return(0,s.bE)("/projectManage/addOrUpdateProject",e)}function l(e){return(0,s.Jt)("/projectManage/getProjectManageListWithUserList",e)}function c(e){return(0,s.bE)("/projectManage/deleteProjectUser",e)}function u(e){return(0,s.bE)("/projectManage/addProjectUser",e)}function o(e){return(0,s.Jt)("/project/getProjectListWithUserList",e)}function i(e){return(0,s.Jt)("/project/getProjectByUuid",e)}function d(e){return(0,s.Jt)("/projectItem/getProjectItemListByProject",e)}function m(e){return(0,s.bE)("/projectItem/endProjectItem",e)}function p(e){return(0,s.bE)("/projectItem/pickProjectItemUser",e)}function g(e){return(0,s.bE)("/projectItem/addProjectItem",e)}function v(e){return(0,s.bE)("/projectItemManage/endProjectItemManage",e)}function k(e){return(0,s.bE)("/projectItemManage/pickProjectItemUserManage",e)}function f(e){return(0,s.bE)("/projectItemManage/addProjectItemManage",e)}function b(e){return(0,s.bE)("/projectItemManage/updateProjectItemTextManage",e)}},7387:function(e,t,a){a.r(t),a.d(t,{default:function(){return A}});a(4114);var s=a(6768),n=a(4232),r=a(8355),l=a(144),c=a(4030),u=a(1387),o=a(1737),i=a(1219),d=a(8374);const m={class:"project-message-back-button-text"},p={class:"common-body-set-width"},g={class:"project-message-card-name"},v={class:"project-message-card-message-div"},k={style:{"margin-right":"10px"}},f={class:"project-message-card-message-icon"},b={class:"project-message-item-body-div"},j={class:"project-message-user-message-div"},y={class:"project-message-user-message-text"},_={class:"project-message-item-title"},F={class:"project-message-item-text-span"},C={class:"project-message-item-footer-div"},L={class:"project-message-user-message-div"},h=["onClick"],x=["onClick"],w={class:"project-message-item-footer-tooltip"},U={class:"project-message-item-footer-tooltip"},E={class:"project-message-pagination-div"},I={class:"project-message-end-confirm-div"},P={class:"project-message-end-confirm-text"},M={class:"project-message-end-confirm-title"},K={class:"project-message-pick-user-div"},W={class:"project-message-user-message-div"},R={class:"project-message-user-message-text"};var V=(0,s.pM)({__name:"ProjectMessage",setup(e){const{t:t}=d.A.global,a=(0,u.lq)(),V=(0,u.rd)(),X=(0,o.C6J)(),A=(0,l.KR)([]),$=(0,l.KR)({}),N=(0,l.KR)(1),Q=(0,l.KR)(0),z=(0,l.KR)(window.innerHeight-340+"px"),J=(0,l.KR)(r.A.defaults.baseURL+"/file/userAvatar/"),S=(0,l.KR)(!1),q=(0,l.KR)(!1),B=(0,l.KR)(""),T=(0,l.KR)(""),H=(0,l.KR)(""),G=(0,l.KR)(!1),O=(0,l.Kh)({title:"",text:""}),D=(0,l.KR)(),Y=(0,l.Kh)({title:[{required:!0,message:t("rules.title"),trigger:"blur"}],text:[{required:!0,message:t("rules.content"),trigger:"blur"}]}),Z=async()=>{try{const e={uuid:a.query.project},t=await(0,c.yx)(e);A.value=t.data||{}}catch{}},ee=async()=>{try{const e={projectUuid:a.query.project,page:N.value},t=await(0,c.Vv)(e);$.value=t.data.projectItemList,Q.value=t.data.total}catch{}};(0,s.sV)((()=>{Z(),ee()}));const te=()=>{V.push({name:"Project",path:"/Project"})},ae=()=>{G.value=!0},se=async e=>{e&&await e.validate(((e,t)=>{e?ne():console.log("error submit!",t)}))},ne=async()=>{try{const e={title:O.title,text:O.text,projectUuid:A.value.uuid},a=await(0,c.Wb)(e);200==a.data.code?((0,i.nk)({message:t("static.addSuccess"),type:"success"}),Z(),ee(),G.value=!1,O.title="",O.text=""):400==a.data.code?(0,i.nk)({message:t("static.addFailed"),type:"warning"}):401==a.data.code?(0,i.nk)({message:t("static.CanNotChangeNotInsideProject"),type:"warning"}):(0,i.nk)({message:t("static.paramsError"),type:"error"})}catch{}},re=()=>{G.value=!1,O.title="",O.text=""},le=e=>{H.value=e.uuid,q.value=!0},ce=e=>{B.value=e.title,T.value=e.uuid,S.value=!0},ue=()=>{S.value=!1},oe=async()=>{try{const e={uuid:T.value,projectUuid:A.value.uuid},a=await(0,c.Su)(e);200==a.data.code?(0,i.nk)({message:t("static.submitSuccess"),type:"success"}):400==a.data.code?(0,i.nk)({message:t("static.submitFailed"),type:"warning"}):401==a.data.code?(0,i.nk)({message:t("static.CanNotChangeNotInsideProject"),type:"warning"}):(0,i.nk)({message:t("static.paramsError"),type:"error"}),Z(),ee(),S.value=!1}catch{}},ie=e=>{0==X.value?A.value.userList[e].background="background: #E5EAF3":A.value.userList[e].background="background: #303030"},de=e=>{A.value.userList[e].background=""},me=async e=>{try{const a={uuid:H.value,projectUuid:A.value.uuid,assignUserUuid:e.uuid},s=await(0,c.po)(a);200==s.data.code?(0,i.nk)({message:t("static.submitSuccess"),type:"success"}):400==s.data.code?(0,i.nk)({message:t("static.submitFailed"),type:"warning"}):401==s.data.code?(0,i.nk)({message:t("static.CanNotChangeNotInsideProject"),type:"warning"}):(0,i.nk)({message:t("static.paramsError"),type:"error"}),Z(),ee(),q.value=!1}catch{}},pe=()=>{Z()},ge=()=>{z.value=window.innerHeight-340+"px"};return ge(),window.addEventListener("resize",ge),(e,t)=>{const a=(0,s.g2)("Back"),r=(0,s.g2)("el-icon"),l=(0,s.g2)("el-button"),c=(0,s.g2)("Unlock"),u=(0,s.g2)("Lock"),o=(0,s.g2)("el-avatar"),i=(0,s.g2)("el-divider"),d=(0,s.g2)("Plus"),V=(0,s.g2)("el-input"),X=(0,s.g2)("el-form-item"),T=(0,s.g2)("Check"),H=(0,s.g2)("Close"),Z=(0,s.g2)("el-form"),ee=(0,s.g2)("el-card"),ne=(0,s.g2)("el-timeline-item"),ge=(0,s.g2)("Warning"),ve=(0,s.g2)("el-tooltip"),ke=(0,s.g2)("SuccessFilled"),fe=(0,s.g2)("el-timeline"),be=(0,s.g2)("el-scrollbar"),je=(0,s.g2)("el-pagination"),ye=(0,s.g2)("el-drawer");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(l,{type:"info",class:"project-message-back-button",onClick:te,plain:""},{default:(0,s.k6)((()=>[(0,s.bF)(r,{size:"20"},{default:(0,s.k6)((()=>[(0,s.bF)(a)])),_:1}),(0,s.Lk)("p",m,(0,n.v_)(e.$t("common.back")),1)])),_:1}),(0,s.Lk)("div",p,[(0,s.Lk)("span",g,(0,n.v_)(A.value.name),1),(0,s.Lk)("div",v,[(0,s.Lk)("span",k,(0,n.v_)(A.value.createTime),1),(0,s.Lk)("span",null,(0,n.v_)(A.value.description),1),(0,s.Lk)("div",f,[0==A.value.isEnded?((0,s.uX)(),(0,s.Wv)(r,{key:0,style:{color:"#67C23A"}},{default:(0,s.k6)((()=>[(0,s.bF)(c)])),_:1})):(0,s.Q3)("",!0),1==A.value.isEnded?((0,s.uX)(),(0,s.Wv)(r,{key:1,style:{color:"#F56C6C"}},{default:(0,s.k6)((()=>[(0,s.bF)(u)])),_:1})):(0,s.Q3)("",!0)])]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(A.value.userList,((e,t)=>((0,s.uX)(),(0,s.Wv)(o,{key:t,src:J.value+e.avatar,class:"project-message-card-message-avatar"},null,8,["src"])))),128)),(0,s.bF)(i,{style:{margin:"20px 0px 10px 0px"}}),(0,s.bF)(be,{height:z.value},{default:(0,s.k6)((()=>[(0,s.Lk)("div",b,[(0,s.bF)(l,{style:{margin:"0px 0px 10px 10px"},type:"primary",onClick:ae},{default:(0,s.k6)((()=>[(0,s.bF)(r,{size:"15"},{default:(0,s.k6)((()=>[(0,s.bF)(d)])),_:1})])),_:1}),(0,s.bF)(fe,null,{default:(0,s.k6)((()=>[G.value?((0,s.uX)(),(0,s.Wv)(ne,{key:0},{default:(0,s.k6)((()=>[(0,s.bF)(ee,null,{default:(0,s.k6)((()=>[(0,s.bF)(Z,{ref_key:"projectItemFormRef",ref:D,model:O,rules:Y,"label-width":"auto"},{default:(0,s.k6)((()=>[(0,s.bF)(X,{prop:"title"},{label:(0,s.k6)((()=>[(0,s.eW)((0,n.v_)(e.$t("common.title")),1)])),default:(0,s.k6)((()=>[(0,s.bF)(V,{modelValue:O.title,"onUpdate:modelValue":t[0]||(t[0]=e=>O.title=e),clearable:"","show-word-limit":"",maxlength:"50"},null,8,["modelValue"])])),_:1}),(0,s.bF)(i),(0,s.bF)(X,{prop:"text"},{label:(0,s.k6)((()=>[(0,s.eW)((0,n.v_)(e.$t("common.content")),1)])),default:(0,s.k6)((()=>[(0,s.bF)(V,{modelValue:O.text,"onUpdate:modelValue":t[1]||(t[1]=e=>O.text=e),clearable:"","show-word-limit":"",maxlength:"300",type:"textarea",autosize:{minRows:3}},null,8,["modelValue"])])),_:1}),(0,s.bF)(X,null,{default:(0,s.k6)((()=>[(0,s.bF)(l,{type:"success",plain:"",onClick:t[2]||(t[2]=e=>se(D.value))},{default:(0,s.k6)((()=>[(0,s.bF)(r,null,{default:(0,s.k6)((()=>[(0,s.bF)(T)])),_:1})])),_:1}),(0,s.bF)(l,{type:"info",plain:"",onClick:t[3]||(t[3]=e=>re())},{default:(0,s.k6)((()=>[(0,s.bF)(r,null,{default:(0,s.k6)((()=>[(0,s.bF)(H)])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)($.value,((t,a)=>((0,s.uX)(),(0,s.Wv)(ne,{key:a,center:""},{default:(0,s.k6)((()=>[(0,s.Lk)("div",j,[(0,s.bF)(o,{src:J.value+t.createUserAvatar},null,8,["src"]),(0,s.Lk)("p",y,(0,n.v_)(t.createUserName)+" "+(0,n.v_)(e.$t("static.createAt"))+" "+(0,n.v_)(t.createTime),1)]),(0,s.bF)(ee,null,{default:(0,s.k6)((()=>[(0,s.Lk)("span",_,(0,n.v_)(t.title),1),(0,s.bF)(i),(0,s.Lk)("span",F,(0,n.v_)(t.text),1)])),_:2},1024),(0,s.Lk)("div",C,[(0,s.bF)(ee,null,{default:(0,s.k6)((()=>[(0,s.Lk)("div",L,[null!=t.assignUserAvatar?((0,s.uX)(),(0,s.Wv)(o,{key:0,onClick:e=>le(t),src:J.value+t.assignUserAvatar},null,8,["onClick","src"])):(0,s.Q3)("",!0),null!=t.assignUserAvatar?((0,s.uX)(),(0,s.CE)("p",{key:1,onClick:e=>le(t),class:"project-message-user-message-text"},(0,n.v_)(t.assignUserName),9,h)):(0,s.Q3)("",!0),null==t.assignUserAvatar?((0,s.uX)(),(0,s.CE)("p",{key:2,onClick:e=>le(t),class:"project-message-user-message-text"},(0,n.v_)(e.$t("static.noMemberAssigned")),9,x)):(0,s.Q3)("",!0),(0,s.bF)(i,{class:"project-message-item-footer-divider",direction:"vertical"}),(0,s.bF)(ve,{effect:"dark",placement:"top-end"},{content:(0,s.k6)((()=>[(0,s.Lk)("span",w,(0,n.v_)(e.$t("static.notFinished")),1)])),default:(0,s.k6)((()=>[0==t.isEnded?((0,s.uX)(),(0,s.Wv)(r,{key:0,onClick:e=>ce(t),style:{color:"#E6A23C"},size:"20"},{default:(0,s.k6)((()=>[(0,s.bF)(ge)])),_:2},1032,["onClick"])):(0,s.Q3)("",!0)])),_:2},1024),(0,s.bF)(ve,{effect:"dark",placement:"top-end"},{content:(0,s.k6)((()=>[(0,s.Lk)("span",U,(0,n.v_)(e.$t("static.isFinished")),1)])),default:(0,s.k6)((()=>[1==t.isEnded?((0,s.uX)(),(0,s.Wv)(r,{key:0,style:{color:"#67C23A"},size:"20"},{default:(0,s.k6)((()=>[(0,s.bF)(ke)])),_:1})):(0,s.Q3)("",!0)])),_:2},1024)])])),_:2},1024)])])),_:2},1024)))),128))])),_:1})])])),_:1},8,["height"]),(0,s.Lk)("div",E,[(0,s.bF)(je,{layout:"prev, pager, next","current-page":N.value,"onUpdate:currentPage":t[4]||(t[4]=e=>N.value=e),onCurrentChange:t[5]||(t[5]=e=>pe()),"page-size":20,total:Q.value,"pager-count":5,background:""},null,8,["current-page","total"])])]),(0,s.bF)(ye,{modelValue:S.value,"onUpdate:modelValue":t[8]||(t[8]=e=>S.value=e),direction:"ttb"},{header:(0,s.k6)((()=>[(0,s.Lk)("h1",null,(0,n.v_)(e.$t("common.confirm")),1)])),default:(0,s.k6)((()=>[(0,s.Lk)("div",I,[(0,s.Lk)("div",P,(0,n.v_)(e.$t("static.endConfirm")),1),(0,s.Lk)("div",M,(0,n.v_)(B.value),1)])])),footer:(0,s.k6)((()=>[(0,s.bF)(l,{type:"info",plain:"",onClick:t[6]||(t[6]=e=>ue())},{default:(0,s.k6)((()=>[(0,s.eW)((0,n.v_)(e.$t("common.no")),1)])),_:1}),(0,s.bF)(l,{type:"danger",onClick:t[7]||(t[7]=e=>oe())},{default:(0,s.k6)((()=>[(0,s.eW)((0,n.v_)(e.$t("common.yes")),1)])),_:1})])),_:1},8,["modelValue"]),(0,s.bF)(ye,{modelValue:q.value,"onUpdate:modelValue":t[9]||(t[9]=e=>q.value=e)},{header:(0,s.k6)((()=>[(0,s.Lk)("h1",null,(0,n.v_)(e.$t("common.choose")),1)])),default:(0,s.k6)((()=>[(0,s.Lk)("div",K,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(A.value.userList,((e,t)=>((0,s.uX)(),(0,s.Wv)(ee,{class:"project-message-pick-user-card",key:t,onMouseover:e=>ie(t),onMouseleave:e=>de(t),style:(0,n.Tr)(e.background),onClick:t=>me(e)},{default:(0,s.k6)((()=>[(0,s.Lk)("div",W,[(0,s.bF)(o,{src:J.value+e.avatar},null,8,["src"]),(0,s.Lk)("p",R,(0,n.v_)(e.username),1)])])),_:2},1032,["onMouseover","onMouseleave","style","onClick"])))),128))])])),_:1},8,["modelValue"])],64)}}});const X=V;var A=X}}]);
//# sourceMappingURL=387.59f36d95.js.map