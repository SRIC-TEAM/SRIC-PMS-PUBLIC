"use strict";(self["webpackChunkfront"]=self["webpackChunkfront"]||[]).push([[402],{4030:function(e,t,a){a.d(t,{$U:function(){return k},B6:function(){return l},FN:function(){return r},G4:function(){return u},HI:function(){return o},KB:function(){return v},KN:function(){return f},Su:function(){return m},Vv:function(){return d},Wb:function(){return p},_M:function(){return i},po:function(){return g},wI:function(){return s},xI:function(){return b},yx:function(){return c}});var n=a(9470);function r(e){return(0,n.Jt)("/projectManage/getProjectManageList",e)}function l(e){return(0,n.bE)("/projectManage/addOrUpdateProject",e)}function u(e){return(0,n.Jt)("/projectManage/getProjectManageListWithUserList",e)}function i(e){return(0,n.bE)("/projectManage/deleteProjectUser",e)}function s(e){return(0,n.bE)("/projectManage/addProjectUser",e)}function o(e){return(0,n.Jt)("/project/getProjectListWithUserList",e)}function c(e){return(0,n.Jt)("/project/getProjectByUuid",e)}function d(e){return(0,n.Jt)("/projectItem/getProjectItemListByProject",e)}function m(e){return(0,n.bE)("/projectItem/endProjectItem",e)}function g(e){return(0,n.bE)("/projectItem/pickProjectItemUser",e)}function p(e){return(0,n.bE)("/projectItem/addProjectItem",e)}function k(e){return(0,n.bE)("/projectItemManage/endProjectItemManage",e)}function v(e){return(0,n.bE)("/projectItemManage/pickProjectItemUserManage",e)}function b(e){return(0,n.bE)("/projectItemManage/addProjectItemManage",e)}function f(e){return(0,n.bE)("/projectItemManage/updateProjectItemTextManage",e)}},1402:function(e,t,a){a.r(t),a.d(t,{default:function(){return V}});a(4114);var n=a(6768),r=a(4232),l=a(8355),u=a(144),i=a(4030),s=a(1387),o=a(1737),c=a(1219),d=a(8374);const m={class:"project-item-manage-back-button-text"},g={class:"common-body-set-width"},p={class:"project-item-manage-card-name"},k={class:"project-item-manage-card-message-div"},v={style:{"margin-right":"10px"}},b={class:"project-item-manage-card-message-icon"},f={class:"project-item-manage-item-body-div"},y={class:"project-item-manage-user-message-div"},F={class:"project-item-manage-user-message-text"},j={class:"project-item-manage-item-title"},_={class:"project-item-manage-item-text-span"},x={class:"project-item-manage-item-footer-div"},h={class:"project-item-manage-user-message-div"},C=["onClick"],w=["onClick"],L={class:"project-item-manage-pagination-div"},I={class:"project-item-manage-delete-confirm-div"},U={class:"project-item-manage-pick-user-div"},E={class:"project-item-manage-user-message-div"},M={class:"project-item-manage-user-message-text"};var P=(0,n.pM)({__name:"ProjectItemManage",setup(e){const{t:t}=d.A.global,a=(0,s.lq)(),P=(0,s.rd)(),K=(0,o.C6J)(),V=(0,u.KR)([]),W=(0,u.KR)({}),R=(0,u.KR)(1),X=(0,u.KR)(0),$=(0,u.KR)(window.innerHeight-340+"px"),A=(0,u.KR)(l.A.defaults.baseURL+"/file/userAvatar/"),z=(0,u.KR)(!1),N=(0,u.KR)(!1),Q=(0,u.KR)(""),B=(0,u.KR)(""),J=(0,u.KR)(!1),S=(0,u.Kh)({title:"",text:""}),q=(0,u.KR)(),T=(0,u.KR)(),H=(0,u.Kh)({title:[{required:!0,message:t("rules.title"),trigger:"blur"}],text:[{required:!0,message:t("rules.content"),trigger:"blur"}]}),G=async()=>{try{const e={uuid:a.query.project},t=await(0,i.yx)(e);V.value=t.data||{}}catch{}},O=async()=>{try{const e={projectUuid:a.query.project,page:R.value},t=await(0,i.Vv)(e);W.value=t.data.projectItemList,X.value=t.data.total}catch{}};(0,n.sV)((()=>{G(),O()}));const D=()=>{P.push({name:"ProjectItemManageIndex",path:"/ProjectItemManageIndex"})},Y=()=>{S.title="",S.text="",z.value=!1,J.value=!0},Z=async e=>{e&&await e.validate(((e,t)=>{e?ee():console.log("error submit!",t)}))},ee=async()=>{try{const e={title:S.title,text:S.text,projectUuid:V.value.uuid},a=await(0,i.xI)(e);200==a.data.code?((0,c.nk)({message:t("static.addSuccess"),type:"success"}),G(),O(),J.value=!1):400==a.data.code?(0,c.nk)({message:t("static.addFailed"),type:"warning"}):401==a.data.code?(0,c.nk)({message:t("static.CanNotChangeNotInsideProject"),type:"warning"}):(0,c.nk)({message:t("static.paramsError"),type:"error"})}catch{}},te=()=>{J.value=!1,S.title="",S.text=""},ae=e=>{B.value=e.uuid,N.value=!0},ne=async(e,a)=>{try{const n={uuid:e.uuid,isEnded:a},r=await(0,i.$U)(n);200==r.data.code?(0,c.nk)({message:t("static.editSuccess"),type:"success"}):400==r.data.code?(0,c.nk)({message:t("static.editFailed"),type:"warning"}):(0,c.nk)({message:t("static.paramsError"),type:"error"}),G(),O()}catch{}},re=e=>{Q.value=e.uuid,S.title=e.title,S.text=e.text,J.value=!1,z.value=!0},le=()=>{z.value=!1},ue=async e=>{e&&await e.validate(((e,t)=>{e?ie():console.log("error submit!",t)}))},ie=async()=>{try{const e={uuid:Q.value,title:S.title,text:S.text},a=await(0,i.KN)(e);200==a.data.code?(0,c.nk)({message:t("static.editSuccess"),type:"success"}):400==a.data.code?(0,c.nk)({message:t("static.editFailed"),type:"warning"}):(0,c.nk)({message:t("static.paramsError"),type:"error"}),G(),O(),z.value=!1}catch{}},se=e=>{0==K.value?V.value.userList[e].background="background: #E5EAF3":V.value.userList[e].background="background: #303030"},oe=e=>{V.value.userList[e].background=""},ce=async e=>{try{const a={uuid:B.value,projectUuid:V.value.uuid,assignUserUuid:e.uuid},n=await(0,i.KB)(a);200==n.data.code?(0,c.nk)({message:t("static.submitSuccess"),type:"success"}):400==n.data.code?(0,c.nk)({message:t("static.submitFailed"),type:"warning"}):401==n.data.code?(0,c.nk)({message:t("static.CanNotChangeNotInsideProject"),type:"warning"}):(0,c.nk)({message:t("static.paramsError"),type:"error"}),G(),O(),N.value=!1}catch{}},de=()=>{G()},me=()=>{$.value=window.innerHeight-340+"px"};return me(),window.addEventListener("resize",me),(e,t)=>{const a=(0,n.g2)("Back"),l=(0,n.g2)("el-icon"),u=(0,n.g2)("el-button"),i=(0,n.g2)("Unlock"),s=(0,n.g2)("Lock"),o=(0,n.g2)("el-avatar"),c=(0,n.g2)("el-divider"),d=(0,n.g2)("Plus"),P=(0,n.g2)("el-input"),K=(0,n.g2)("el-form-item"),Q=(0,n.g2)("Check"),B=(0,n.g2)("Close"),G=(0,n.g2)("el-form"),O=(0,n.g2)("el-card"),ee=(0,n.g2)("el-timeline-item"),ie=(0,n.g2)("Edit"),me=(0,n.g2)("Warning"),ge=(0,n.g2)("SuccessFilled"),pe=(0,n.g2)("el-popover"),ke=(0,n.g2)("el-timeline"),ve=(0,n.g2)("el-scrollbar"),be=(0,n.g2)("el-pagination"),fe=(0,n.g2)("el-drawer");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(u,{type:"info",class:"project-item-manage-back-button",onClick:D,plain:""},{default:(0,n.k6)((()=>[(0,n.bF)(l,{size:"20"},{default:(0,n.k6)((()=>[(0,n.bF)(a)])),_:1}),(0,n.Lk)("p",m,(0,r.v_)(e.$t("common.back")),1)])),_:1}),(0,n.Lk)("div",g,[(0,n.Lk)("span",p,(0,r.v_)(V.value.name),1),(0,n.Lk)("div",k,[(0,n.Lk)("span",v,(0,r.v_)(V.value.createTime),1),(0,n.Lk)("span",null,(0,r.v_)(V.value.description),1),(0,n.Lk)("div",b,[0==V.value.isEnded?((0,n.uX)(),(0,n.Wv)(l,{key:0,style:{color:"#67C23A"}},{default:(0,n.k6)((()=>[(0,n.bF)(i)])),_:1})):(0,n.Q3)("",!0),1==V.value.isEnded?((0,n.uX)(),(0,n.Wv)(l,{key:1,style:{color:"#F56C6C"}},{default:(0,n.k6)((()=>[(0,n.bF)(s)])),_:1})):(0,n.Q3)("",!0)])]),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(V.value.userList,((e,t)=>((0,n.uX)(),(0,n.Wv)(o,{key:t,src:A.value+e.avatar,class:"project-item-manage-card-message-avatar"},null,8,["src"])))),128)),(0,n.bF)(c,{style:{margin:"20px 0px 10px 0px"}}),(0,n.bF)(ve,{height:$.value},{default:(0,n.k6)((()=>[(0,n.Lk)("div",f,[(0,n.bF)(u,{style:{margin:"0px 0px 10px 10px"},type:"primary",onClick:Y},{default:(0,n.k6)((()=>[(0,n.bF)(l,{size:"15"},{default:(0,n.k6)((()=>[(0,n.bF)(d)])),_:1})])),_:1}),(0,n.bF)(ke,null,{default:(0,n.k6)((()=>[J.value?((0,n.uX)(),(0,n.Wv)(ee,{key:0},{default:(0,n.k6)((()=>[(0,n.bF)(O,null,{default:(0,n.k6)((()=>[(0,n.bF)(G,{ref_key:"projectItemFormRef",ref:q,model:S,rules:H,"label-width":"auto"},{default:(0,n.k6)((()=>[(0,n.bF)(K,{prop:"title"},{label:(0,n.k6)((()=>[(0,n.eW)((0,r.v_)(e.$t("common.title")),1)])),default:(0,n.k6)((()=>[(0,n.bF)(P,{modelValue:S.title,"onUpdate:modelValue":t[0]||(t[0]=e=>S.title=e),clearable:"","show-word-limit":"",maxlength:"50"},null,8,["modelValue"])])),_:1}),(0,n.bF)(c),(0,n.bF)(K,{prop:"text"},{label:(0,n.k6)((()=>[(0,n.eW)((0,r.v_)(e.$t("common.content")),1)])),default:(0,n.k6)((()=>[(0,n.bF)(P,{modelValue:S.text,"onUpdate:modelValue":t[1]||(t[1]=e=>S.text=e),clearable:"","show-word-limit":"",maxlength:"300",type:"textarea",autosize:{minRows:3}},null,8,["modelValue"])])),_:1}),(0,n.bF)(K,null,{default:(0,n.k6)((()=>[(0,n.bF)(u,{type:"success",plain:"",onClick:t[2]||(t[2]=e=>Z(q.value))},{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(Q)])),_:1})])),_:1}),(0,n.bF)(u,{type:"info",plain:"",onClick:t[3]||(t[3]=e=>te())},{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(B)])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})):(0,n.Q3)("",!0),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(W.value,((t,a)=>((0,n.uX)(),(0,n.Wv)(ee,{key:a,center:""},{default:(0,n.k6)((()=>[(0,n.Lk)("div",y,[(0,n.bF)(o,{src:A.value+t.createUserAvatar},null,8,["src"]),(0,n.Lk)("p",F,(0,r.v_)(t.createUserName)+" "+(0,r.v_)(e.$t("static.createAt"))+" "+(0,r.v_)(t.createTime),1)]),(0,n.bF)(O,null,{default:(0,n.k6)((()=>[(0,n.bF)(u,{onClick:e=>re(t),type:"primary",style:{float:"right"},plain:""},{default:(0,n.k6)((()=>[(0,n.bF)(l,{size:"15"},{default:(0,n.k6)((()=>[(0,n.bF)(ie)])),_:1})])),_:2},1032,["onClick"]),(0,n.Lk)("span",j,(0,r.v_)(t.title),1),(0,n.bF)(c),(0,n.Lk)("span",_,(0,r.v_)(t.text),1)])),_:2},1024),(0,n.Lk)("div",x,[(0,n.bF)(O,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",h,[null!=t.assignUserAvatar?((0,n.uX)(),(0,n.Wv)(o,{key:0,onClick:e=>ae(t),src:A.value+t.assignUserAvatar},null,8,["onClick","src"])):(0,n.Q3)("",!0),null!=t.assignUserAvatar?((0,n.uX)(),(0,n.CE)("p",{key:1,onClick:e=>ae(t),class:"project-item-manage-user-message-text"},(0,r.v_)(t.assignUserName),9,C)):(0,n.Q3)("",!0),null==t.assignUserAvatar?((0,n.uX)(),(0,n.CE)("p",{key:2,onClick:e=>ae(t),class:"project-item-manage-user-message-text"},(0,r.v_)(e.$t("static.noMemberAssigned")),9,w)):(0,n.Q3)("",!0),(0,n.bF)(c,{class:"project-item-manage-item-footer-divider",direction:"vertical"}),(0,n.bF)(pe,{placement:"left-start"},{reference:(0,n.k6)((()=>[0==t.isEnded?((0,n.uX)(),(0,n.Wv)(l,{key:0,style:{color:"#E6A23C"},size:"20"},{default:(0,n.k6)((()=>[(0,n.bF)(me)])),_:1})):(0,n.Q3)("",!0),1==t.isEnded?((0,n.uX)(),(0,n.Wv)(l,{key:1,style:{color:"#67C23A"},size:"20"},{default:(0,n.k6)((()=>[(0,n.bF)(ge)])),_:1})):(0,n.Q3)("",!0)])),default:(0,n.k6)((()=>[(0,n.bF)(u,{onClick:e=>ne(t,1),type:"success",link:""},{default:(0,n.k6)((()=>[(0,n.bF)(l,{style:{"margin-right":"10px"},size:"15"},{default:(0,n.k6)((()=>[(0,n.bF)(ge)])),_:1}),(0,n.eW)(" "+(0,r.v_)(e.$t("static.isFinished")),1)])),_:2},1032,["onClick"]),(0,n.bF)(c,{style:{margin:"10px 0px 10px 0px"}}),(0,n.bF)(u,{onClick:e=>ne(t,0),type:"warning",link:""},{default:(0,n.k6)((()=>[(0,n.bF)(l,{style:{"margin-right":"10px"},size:"15"},{default:(0,n.k6)((()=>[(0,n.bF)(me)])),_:1}),(0,n.eW)(" "+(0,r.v_)(e.$t("static.notFinished")),1)])),_:2},1032,["onClick"])])),_:2},1024)])])),_:2},1024)])])),_:2},1024)))),128))])),_:1})])])),_:1},8,["height"]),(0,n.Lk)("div",L,[(0,n.bF)(be,{layout:"prev, pager, next","current-page":R.value,"onUpdate:currentPage":t[4]||(t[4]=e=>R.value=e),onCurrentChange:t[5]||(t[5]=e=>de()),"page-size":20,total:X.value,"pager-count":5,background:""},null,8,["current-page","total"])])]),(0,n.bF)(fe,{modelValue:z.value,"onUpdate:modelValue":t[10]||(t[10]=e=>z.value=e),direction:"ttb"},{header:(0,n.k6)((()=>[(0,n.Lk)("h1",null,(0,r.v_)(e.$t("common.confirm")),1)])),default:(0,n.k6)((()=>[(0,n.Lk)("div",I,[(0,n.bF)(G,{ref_key:"editProjectItemFormRef",ref:T,model:S,rules:H,"label-width":"auto"},{default:(0,n.k6)((()=>[(0,n.bF)(K,{prop:"title"},{label:(0,n.k6)((()=>[(0,n.eW)((0,r.v_)(e.$t("common.title")),1)])),default:(0,n.k6)((()=>[(0,n.bF)(P,{modelValue:S.title,"onUpdate:modelValue":t[6]||(t[6]=e=>S.title=e),clearable:"","show-word-limit":"",maxlength:"50"},null,8,["modelValue"])])),_:1}),(0,n.bF)(c),(0,n.bF)(K,{prop:"text"},{label:(0,n.k6)((()=>[(0,n.eW)((0,r.v_)(e.$t("common.content")),1)])),default:(0,n.k6)((()=>[(0,n.bF)(P,{modelValue:S.text,"onUpdate:modelValue":t[7]||(t[7]=e=>S.text=e),clearable:"","show-word-limit":"",maxlength:"300",type:"textarea",autosize:{minRows:3}},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])])),footer:(0,n.k6)((()=>[(0,n.bF)(u,{type:"info",plain:"",onClick:t[8]||(t[8]=e=>le())},{default:(0,n.k6)((()=>[(0,n.eW)((0,r.v_)(e.$t("common.no")),1)])),_:1}),(0,n.bF)(u,{type:"danger",onClick:t[9]||(t[9]=e=>ue(T.value))},{default:(0,n.k6)((()=>[(0,n.eW)((0,r.v_)(e.$t("common.yes")),1)])),_:1})])),_:1},8,["modelValue"]),(0,n.bF)(fe,{modelValue:N.value,"onUpdate:modelValue":t[11]||(t[11]=e=>N.value=e)},{header:(0,n.k6)((()=>[(0,n.Lk)("h1",null,(0,r.v_)(e.$t("common.choose")),1)])),default:(0,n.k6)((()=>[(0,n.Lk)("div",U,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(V.value.userList,((e,t)=>((0,n.uX)(),(0,n.Wv)(O,{class:"project-item-manage-pick-user-card",key:t,onMouseover:e=>se(t),onMouseleave:e=>oe(t),style:(0,r.Tr)(e.background),onClick:t=>ce(e)},{default:(0,n.k6)((()=>[(0,n.Lk)("div",E,[(0,n.bF)(o,{src:A.value+e.avatar},null,8,["src"]),(0,n.Lk)("p",M,(0,r.v_)(e.username),1)])])),_:2},1032,["onMouseover","onMouseleave","style","onClick"])))),128))])])),_:1},8,["modelValue"])],64)}}});const K=P;var V=K}}]);
//# sourceMappingURL=402.a358fcaf.js.map